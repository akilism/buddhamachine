<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../buddha-speaker/buddha-speaker.html">
<link rel="import" href="../buddha-menu/buddha-menu.html">

<polymer-element name="buddha-machine">
  <template>
    <link rel="stylesheet" href="buddha-machine.css">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <div class="machine-back" on-colorchange="{{changeColor}}" on-tap="{{menuHandler}}" touch-action="none">
      <div class="playing-indicator">
        <i class="fa fa-2x fa-volume-off off"></i>
        <i class="fa fa-2x fa-volume-up on"></i>
      </div>
      <buddha-speaker
        color="{{color}}"
        sound="{{sound}}"
        playing="{{playing}}"
        on-tap="{{playHandler}}"
        touch-action="none">
      </buddha-speaker>
    </div>
    <buddha-menu show="{{showMenu}}" color="{{color}}" sound="{{sound}}"></buddha-menu>
  </template>
  <script>
    (function () {
      'use strict';

      Polymer({
        publish: {
          showMenu: {
            value: false,
            reflect: true
          },
          playing: {
            value: false,
            reflect: true
          },
          color: {
            value: '',
            reflect: true
          },
          sound: 'https://s3.amazonaws.com/buddhamachine/version1/0.mp3',
        },
        created: function () {
        },
        playHandler: function (event, detail, sender) {
          this.playing = !this.playing;
          event.stopPropagation();
          event.preventDefault();
        },
        menuHandler: function (event, detail, sender) {
          this.showMenu = !this.showMenu;
        },
        changeColor: function (event) {
          console.log(event);
          this.color = event.detail;
        }
      });

    })();
  </script>
</polymer-element>
